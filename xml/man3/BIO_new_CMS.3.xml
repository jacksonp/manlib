<!-- Converted by db4-upgrade version 1.1 -->
<refentry xmlns="http://docbook.org/ns/docbook" version="5.0">
  <refmeta>
    <refentrytitle>BIO_new_CMS.pod</refentrytitle>
  </refmeta>
  <refnamediv>
    <refname>BIO_new_CMS</refname>
    <refpurpose>CMS streaming filter BIO</refpurpose>
  </refnamediv>
  <refsynopsisdiv>
<synopsis format="linespecific">#include &lt;openssl/cms.h&gt;</synopsis>
<synopsis format="linespecific">BIO *BIO_new_CMS(BIO *out, CMS_ContentInfo *cms);</synopsis>
  </refsynopsisdiv>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:DESCRIPTION"><title>DESCRIPTION</title>
    <para>
      BIO_new_CMS() returns a streaming filter BIO chain based on <emphasis role="bold">cms</emphasis>. The output of the filter is written to
      <emphasis role="bold">out</emphasis>. Any data written to the chain
      is automatically translated to a BER format CMS structure of the
      appropriate type.
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:NOTES"><title>NOTES</title>
    <para>
      The chain returned by this function behaves like a standard filter
      BIO. It supports non blocking I/O. Content is processed and streamed
      on the fly and not all held in memory at once: so it is possible to
      encode very large structures. After all content has been written
      through the chain BIO_flush() must be called to finalise the
      structure.
    </para>
    <para>
      The <emphasis role="bold">CMS_STREAM</emphasis> flag must be included
      in the corresponding <emphasis role="bold">flags</emphasis> parameter
      of the <emphasis role="bold">cms</emphasis> creation function.
    </para>
    <para>
      If an application wishes to write additional data to <emphasis role="bold">out</emphasis> BIOs should be removed from the chain
      using BIO_pop() and freed with BIO_free() until <emphasis role="bold">out</emphasis> is reached. If no additional data needs to
      be written BIO_free_all() can be called to free up the whole chain.
    </para>
    <para>
      Any content written through the filter is used verbatim: no canonical
      translation is performed.
    </para>
    <para>
      It is possible to chain multiple BIOs to, for example, create a
      triple wrapped signed, enveloped, signed structure. In this case it
      is the applications responsibility to set the inner content type of
      any outer CMS_ContentInfo structures.
    </para>
    <para>
      Large numbers of small writes through the chain should be avoided as
      this will produce an output consisting of lots of OCTET STRING
      structures. Prepending a BIO_f_buffer() buffering BIO will prevent
      this.
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:BUGS"><title>BUGS</title>
    <para>
      There is currently no corresponding inverse BIO: i.e. one which can
      decode a CMS structure on the fly.
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:RETURN_VALUES"><title>RETURN VALUES</title>
    <para>
      BIO_new_CMS() returns a BIO chain when successful or NULL if an error
      occurred. The error can be obtained from ERR_get_error(3).
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:SEE_ALSO"><title>SEE ALSO</title>
    <para>
      ERR_get_error(3), CMS_sign(3), CMS_encrypt(3)
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BIO_new_CMS.pod:HISTORY"><title>HISTORY</title>
    <para>
      BIO_new_CMS() was added to OpenSSL 1.0.0
    </para>
  </refsection>
</refentry>