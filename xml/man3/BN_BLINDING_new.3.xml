<!-- Converted by db4-upgrade version 1.1 -->
<refentry xmlns="http://docbook.org/ns/docbook" version="5.0">
  <refmeta>
    <refentrytitle>BN_BLINDING_new.pod</refentrytitle>
  </refmeta>
  <refnamediv>
    <refname>BN_BLINDING_new, BN_BLINDING_free, BN_BLINDING_update, BN_BLINDING_convert,
BN_BLINDING_invert, BN_BLINDING_convert_ex, BN_BLINDING_invert_ex, 
BN_BLINDING_get_thread_id, BN_BLINDING_set_thread_id, BN_BLINDING_thread_id, BN_BLINDING_get_flags,
BN_BLINDING_set_flags, BN_BLINDING_create_param</refname>
<refpurpose>blinding related BIGNUM
functions.

</refpurpose>
  </refnamediv>
  <refsynopsisdiv>
<synopsis format="linespecific">#include &lt;openssl/bn.h&gt;</synopsis>
<synopsis format="linespecific">BN_BLINDING *BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai,
       BIGNUM *mod);
void BN_BLINDING_free(BN_BLINDING *b);
int BN_BLINDING_update(BN_BLINDING *b,BN_CTX *ctx);
int BN_BLINDING_convert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
int BN_BLINDING_invert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
int BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b,
       BN_CTX *ctx);
int BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
       BN_CTX *ctx);
#ifndef OPENSSL_NO_DEPRECATED
unsigned long BN_BLINDING_get_thread_id(const BN_BLINDING *);
void BN_BLINDING_set_thread_id(BN_BLINDING *, unsigned long);
#endif
CRYPTO_THREADID *BN_BLINDING_thread_id(BN_BLINDING *);
unsigned long BN_BLINDING_get_flags(const BN_BLINDING *);
void BN_BLINDING_set_flags(BN_BLINDING *, unsigned long);
BN_BLINDING *BN_BLINDING_create_param(BN_BLINDING *b,
       const BIGNUM *e, BIGNUM *m, BN_CTX *ctx,
       int (*bn_mod_exp)(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                         const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx),
       BN_MONT_CTX *m_ctx);</synopsis>
  </refsynopsisdiv>
  <refsection xml:id="sources.openssl.doc.crypto.BN_BLINDING_new.pod:DESCRIPTION"><title>DESCRIPTION</title>
    <para>
      BN_BLINDING_new() allocates a new <emphasis role="bold">BN_BLINDING</emphasis> structure and copies the <emphasis role="bold">A</emphasis> and <emphasis role="bold">Ai</emphasis>
      values into the newly created <emphasis role="bold">BN_BLINDING</emphasis> object.
    </para>
    <para>
      BN_BLINDING_free() frees the <emphasis role="bold">BN_BLINDING</emphasis> structure. If <emphasis role="bold">b</emphasis> is NULL, nothing is done.
    </para>
    <para>
      BN_BLINDING_update() updates the <emphasis role="bold">BN_BLINDING</emphasis> parameters by squaring the
      <emphasis role="bold">A</emphasis> and <emphasis role="bold">Ai</emphasis> or, after specific number of uses and if
      the necessary parameters are set, by re-creating the blinding
      parameters.
    </para>
    <para>
      BN_BLINDING_convert_ex() multiplies <emphasis role="bold">n</emphasis> with the blinding factor <emphasis role="bold">A</emphasis>. If <emphasis role="bold">r</emphasis> is
      not NULL a copy the inverse blinding factor <emphasis role="bold">Ai</emphasis> will be returned in <emphasis role="bold">r</emphasis> (this is useful if a <emphasis role="bold">RSA</emphasis> object is shared among several threads).
      BN_BLINDING_invert_ex() multiplies <emphasis role="bold">n</emphasis>
      with the inverse blinding factor <emphasis role="bold">Ai</emphasis>.
      If <emphasis role="bold">r</emphasis> is not NULL it will be used as
      the inverse blinding.
    </para>
    <para>
      BN_BLINDING_convert() and BN_BLINDING_invert() are wrapper functions
      for BN_BLINDING_convert_ex() and BN_BLINDING_invert_ex() with
      <emphasis role="bold">r</emphasis> set to NULL.
    </para>
    <para>
      BN_BLINDING_thread_id() provides access to the <emphasis role="bold">CRYPTO_THREADID</emphasis> object within the <emphasis role="bold">BN_BLINDING</emphasis> structure. This is to help users
      provide proper locking if needed for multi-threaded use. The "thread
      id" object of a newly allocated <emphasis role="bold">BN_BLINDING</emphasis> structure is initialised to the
      thread id in which BN_BLINDING_new() was called.
    </para>
    <para>
      BN_BLINDING_get_flags() returns the BN_BLINDING flags. Currently
      there are two supported flags: <emphasis role="bold">BN_BLINDING_NO_UPDATE</emphasis> and <emphasis role="bold">BN_BLINDING_NO_RECREATE</emphasis>. <emphasis role="bold">BN_BLINDING_NO_UPDATE</emphasis> inhibits the automatic
      update of the <emphasis role="bold">BN_BLINDING</emphasis> parameters
      after each use and <emphasis role="bold">BN_BLINDING_NO_RECREATE</emphasis> inhibits the automatic
      re-creation of the <emphasis role="bold">BN_BLINDING</emphasis>
      parameters after a fixed number of uses (currently 32). In newly
      allocated <emphasis role="bold">BN_BLINDING</emphasis> objects no
      flags are set. BN_BLINDING_set_flags() sets the <emphasis role="bold">BN_BLINDING</emphasis> parameters flags.
    </para>
    <para>
      BN_BLINDING_create_param() creates new <emphasis role="bold">BN_BLINDING</emphasis> parameters using the exponent
      <emphasis role="bold">e</emphasis> and the modulus <emphasis role="bold">m</emphasis>. <emphasis role="bold">bn_mod_exp</emphasis>
      and <emphasis role="bold">m_ctx</emphasis> can be used to pass
      special functions for exponentiation (normally BN_mod_exp_mont() and
      <emphasis role="bold">BN_MONT_CTX</emphasis>).
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BN_BLINDING_new.pod:RETURN_VALUES"><title>RETURN VALUES</title>
    <para>
      BN_BLINDING_new() returns the newly allocated <emphasis role="bold">BN_BLINDING</emphasis> structure or NULL in case of an
      error.
    </para>
    <para>
      BN_BLINDING_update(), BN_BLINDING_convert(), BN_BLINDING_invert(),
      BN_BLINDING_convert_ex() and BN_BLINDING_invert_ex() return 1 on
      success and 0 if an error occurred.
    </para>
    <para>
      BN_BLINDING_thread_id() returns a pointer to the thread id object
      within a <emphasis role="bold">BN_BLINDING</emphasis> object.
    </para>
    <para>
      BN_BLINDING_get_flags() returns the currently set <emphasis role="bold">BN_BLINDING</emphasis> flags (a <emphasis role="bold">unsigned long</emphasis> value).
    </para>
    <para>
      BN_BLINDING_create_param() returns the newly created <emphasis role="bold">BN_BLINDING</emphasis> parameters or NULL on error. 
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BN_BLINDING_new.pod:SEE_ALSO"><title>SEE ALSO</title>
    <para>
      bn(3)
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BN_BLINDING_new.pod:HISTORY"><title>HISTORY</title>
    <para>
      BN_BLINDING_thread_id was first introduced in OpenSSL 1.0.0, and it
      deprecates BN_BLINDING_set_thread_id and BN_BLINDING_get_thread_id.
    </para>
    <para>
      BN_BLINDING_convert_ex, BN_BLINDIND_invert_ex,
      BN_BLINDING_get_thread_id, BN_BLINDING_set_thread_id,
      BN_BLINDING_set_flags, BN_BLINDING_get_flags and
      BN_BLINDING_create_param were first introduced in OpenSSL 0.9.8
    </para>
  </refsection>
  <refsection xml:id="sources.openssl.doc.crypto.BN_BLINDING_new.pod:AUTHOR"><title>AUTHOR</title>
    <para>
      Nils Larsch for the OpenSSL project (http://www.openssl.org).
    </para>
  </refsection>
</refentry>